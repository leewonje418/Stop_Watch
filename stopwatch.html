<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StopWatch</title>
    <style type="text/css">
        body{
            background: #000000;
            color: #00D8FF;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .stopwatch {
            font-size: 15em;
            font-family: monospace;
        }

        ul {
            margin: 0;
            padding: 0;
        }

        ul li {
            list-style: none;
            padding: 10px 0;
        }
    </style>
</head>
<body onkeydown="keyup()">
    <div class="contols">
        <button onclick="startAndStop()" id="start">Start</button>
        <button onclick="lap()">Lap</button>
    </div>
 
    <div class="stopwatch">00:00:00</div>
    <div>
        <div id="average">
        </div>    
        <div id="max">
        </div> 
        <div id="min">
        </div>    
    </div>
    <ul class="laps"></ul>

    <script type="text/javascript">
        var ms = 0, s = 0, m = 0;
        var timer;
        var laps = false;
        var average, max, min;
        var stopwatchEl = document.querySelector('.stopwatch');
        var lapsContainer = document.querySelector('.laps');

        function startAndStop() {
            console.log(laps);
            if(laps == true) {
                clearInterval(timer);
                document.getElementById("start").innerText = "Start";
                 
                timer = false;
                laps = false;
            }
            if(!timer) {
                document.getElementById("start").innerText = "Stop";
                timer = setInterval(run, 10);
            } else if(timer) {
                document.getElementById("start").innerText = "Start";
                clearInterval(timer);
                timer=false;
            }
        }
        function keyup(){
            document.addEventListener('keydown', function(e){
                const keyCode = e.keyCode;
                if(keyCode == 37){ // Left key
                    startAndStop()
                } else if(keyCode == 39){ // Right key
                    lap()
                }
            })
        }

        function run() {
            var code = getTimer();
            stopwatchEl.textContent = `${code[0]}:${code[1]}:${code[2]}`;
            ms++;
            if(ms == 100) {
                ms = 0;
                s++;
            } 
            if(s == 60) {
                s = 0;
                m++;
            }
        }

        function resetTimer() {
            clearInterval(timer);
            timer = false;
        }

        function getTimer() {
            // return (m < 10 ? '0' + m : m) + ':' + (s < 10 ? '0' + s : s) + ':' + (ms < 10 ? '0' + ms : ms);
            return [m < 10 ? '0' + m : m, s < 10 ? '0' + s : s, ms < 10 ? '0' + ms : ms];
        }

        function lap() {
            if(timer) {
                var code = getTimer();
                var li = document.createElement('li');
                li.innerText = `${code[0]}:${code[1]}:${code[2]}`;
                lapsContainer.appendChild(li);
            } else {
                resetTimer();
                m = 0;
                s = 0;
                ms = 0;
                var code = getTimer();
                stopwatchEl.textContent = `${code[0]}:${code[1]}:${code[2]}`;
                lapsContainer.innerHTML = '';
            }
        }
    </script>
</body>
</html>